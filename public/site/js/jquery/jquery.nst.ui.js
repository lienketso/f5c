!function(a){var b=window.location.href.match(/^https?:\/\/(localhost|192\.168\.1\.)/gi),c={method:"",lightbox:{opacity:.75,transition:"none"},loadAjax:{url:"",data:"",field:{load:"",show:""},datatype:"html",event_complete:"",event_error:""},formAction:{action:"",field_load:"",submit:!1,event_submit:"",event_complete:"",event_error:"",loading:!1},verifyAction:{field:"verify_action",event_complete:"",loading:!1},confirmAction:{field_load:"",event_complete:""},placeholder:{},toggleTab:{field:"",effect:"blind",duration:300},toggleAction:{},tooltip:{},dropdown:{},copyValue:{from:"",to:""},accordion:{type:""},tabs:{class_active:"active",class_tab:"tab",class_tab_content:"tab_content",effect:"",duration:0},moreList:{item:"",num:0},moreBlock:{}};a.fn.nstUI=function(d,e){return"object"==typeof d&&(e=d[d.method],d=d.method),a(this).each(function(){function h(){var b=new Array,c=f.attr("href"),d=c.split("?lightbox&");if(d[1])for(var e=d[1].split("&"),h=0;h<e.length;h++){var i=e[h].split("=");i[1]&&("true"==i[1]?i[1]=!0:"false"==i[1]&&(i[1]=!1),b[i[0]]=i[1])}return b.href=d[0],b=a.extend({},g,b),f.colorbox(b),!1}function i(){var b=g.url,c=g.field;return!!b&&(y("show",c.load),a.post(b,g.data,function(a){y("hide",c.load),y("result",c.show,a),"function"==typeof g.event_complete&&g.event_complete.call(this,a,g)},g.datatype).error(function(){y("hide",c.load),y("error",c.show,b),"function"==typeof g.event_error&&g.event_error.call(this,g)}),!1)}function j(){var b=a(this).attr("name");if(b){var c=a(this).attr("value");c=c?c:"";var d=f.find('[name="'+b+'_autocheck"]');d.html('<div id="loader"></div>').show();var e=g.action;e=e?e:f.attr("action"),e=e?e:window.location.href;var h=f.attr("method");h=h?h:"POST",f.ajaxSubmit({url:e,type:h,data:{_autocheck:b},dataType:"json",success:function(a,c,e,g){var h=f.find('[name="'+b+'_error"]');a.accept?(d.html('<div id="accept"></div>').show(),h.html(a.error).hide("blind")):(d.html('<div id="error"></div>').show(),h.html(a.error).show("blind",200))},error:function(a,c,e){var g=f.find('[name="'+b+'_error"]');d.hide(),g.hide()}})}}function k(){if(g.loading)return!1;if("function"==typeof g.event_submit){var a=g.event_submit.call(this,g);if(0==a)return!1}g.loading=!0,y("show",g.field_load);var b=g.action;b=b?b:f.attr("action"),b=b?b:window.location.href;var c=f.attr("method");return c=c?c:"POST",f.ajaxSubmit({url:b,type:c,data:{_submit:"true"},dataType:"json",success:function(a,b,c,d){l(a)},error:function(a,b,c){l()}}),!1}function l(c){return g.loading=!1,y("hide",g.field_load),void 0==c?void(b?alert("Có lỗi xẩy ra trong qua trình xử lý"):alert("Có lỗi xẩy ra trong qua trình xử lý")):(f.find("[name$=_error]").html(""),void(c.complete?"function"==typeof g.event_complete?g.event_complete.call(this,c,g):void 0!=c.location?c.location?window.parent.location=c.location:window.location.reload():void 0!=c.color_box?c.color_box&&a.colorbox({href:c.color_box_url}):void 0!=c.msg&&(c.msg&&alert(c.msg),void 0!=c.reset_form&&a(".form_action").trigger("reset")):(a.each(c,function(a,b){f.find('[name="'+a+'_error"]').html(b).show("blind",200)}),"function"==typeof g.event_error&&g.event_error.call(this,c,g))))}function m(){var b={is_loading:function(){return g.loading},set_loading:function(){g.loading=!0},reset:function(){g.loading=!1,a.colorbox.close()}},c=a(this).attr("_url");if(c=c?c:a(this).attr("href"),!c)return!1;var d=a("#"+g.field);return d.find("#notice").html(a(this).attr("notice")),a.colorbox({inline:!0,href:"#"+g.field,opacity:.75}),d.find("#accept").click(function(){return!b.is_loading()&&(b.set_loading(),a(this).nstUI("loadAjax",{url:c,field:{load:g.field+"_load"},event_complete:function(a,c){b.reset(),"function"==typeof g.event_complete?g.event_complete.call(this,a,g):window.location.reload()},event_error:function(a){b.reset()}}),!1)}),d.find("#cancel").click(function(){return b.reset(),!1}),!1}function n(){var a=f.attr("_url");if(a=a?a:f.attr("href"),!a)return!1;var b=f.attr("_notice");return 1==confirm(b)&&f.nstUI({method:"loadAjax",loadAjax:{url:a,field:{load:g.field_load,show:""},event_complete:function(a,b){"function"==typeof g.event_complete?g.event_complete.call(this,a,g):window.location.reload()},event_error:function(a){window.location.reload()}}}),!1}function o(){if(!f.val()){var a=f.attr("placeholder");f.val(a)}f.focus(function(){var a=f.attr("placeholder");f.val()==a&&f.val("")}).blur(function(){if(!f.val()){var a=f.attr("placeholder");f.val(a)}})}function p(){function h(){e.find("[_"+b+"]").hide();var a=f.val();""!=a&&(e.find("[_"+b+"="+a+"]").show(),e.show(c,d))}var b=g.field,c=g.effect,d=g.duration,e=a("#"+b);"none"!=e.css("display")?e.hide(c,d,function(){h()}):h()}function q(){function b(a){a?f.addClass("on"):f.removeClass("on"),c(!a)}function c(a){void 0==a&&(a=!f.hasClass("on"));var b=a?"on":"off",c=f.attr("_title_"+b);f.attr("title",c)}c(),f.click(function(){var c=f.hasClass("on")?"off":"on",d=f.attr("_url_"+c);if(!d)return!1;var e="on"==c;return b(e),a.post(d,function(a){a.complete||b(!e)},"json").error(function(){b(!e)}),!1})}function r(){f.hover(function(){var a=f.attr("_tooltip");f.find("#"+a).stop(!0,!0).slideDown(200)},function(){var a=f.attr("_tooltip");f.find("#"+a).stop(!0,!0).slideUp(200)})}function s(){var b="#"+f.attr("_dropdown"),c=a(b),d=f.attr("_dropdown_effect");d=d?d:"blind",f.click(function(){c.stop(!0,!0).toggle(d,200)}),a(document).bind("click",function(a){if("none"!=c.css("display")){var b=a.target;f[0]!=b&&void 0==f.find(b)[0]&&c[0]!=b&&void 0==c.find(b)[0]&&c.stop(!0,!0).hide(d,200)}})}function t(){var b=a("#"+g.from),c=a("#"+g.to);return b.find("[_param]").each(function(){var b=a(this).attr("_param"),d=a(this).val();c.find('[_param="'+b+'"]').val(d)}),!1}function u(){f.find("[_title]").click(function(){var b=a(this),c=b.attr("_title");switch(g.type){case"2":b.toggleClass("acc_active"),f.find('[_title][_title!="'+c+'"]').removeClass("acc_active"),f.find('[_body="'+c+'"]').stop(!0,!0).slideToggle(),f.find('[_body][_body!="'+c+'"]').stop(!0,!0).slideUp();break;default:b.toggleClass("acc_active").siblings("[_title]").removeClass("acc_active"),b.siblings("[_body="+c+"]").stop(!0,!0).slideToggle().siblings("[_body]").stop(!0,!0).slideUp()}return!1})}function v(){function c(a){f.find("."+g.class_tab).removeClass(g.class_active),f.find("."+g.class_tab+"#"+a).addClass(g.class_active),f.find("."+g.class_tab_content).hide(),f.find("."+g.class_tab_content+"#"+a+"_content").show(g.effect)}var b=f.find("."+g.class_tab+"."+g.class_active).attr("id");b=b?b:f.find("."+g.class_tab+":first").attr("id"),c(b),f.find("."+g.class_tab).click(function(){if(!a(this).hasClass(g.class_active)){var b=a(this).attr("id");c(b)}return!1})}function w(){function h(g){f.find(b).each(function(b){b<c?a(this).show():a(this).hide()}),d.show(),e.hide(),g&&a.scrollTo(f.find(b),800)}function i(){f.find(b).show(),d.hide(),e.show()}var b=g.item,c=g.num,d=f.find("#act_all"),e=f.find("#act_short");return h(!1),d.click(function(){return i(),!1}),e.click(function(){return h(!0),!1}),!1}function x(){function d(b){f.removeClass("block_all"),b&&a.scrollTo(f,800)}function e(){f.addClass("block_all")}var b=f.find("#block_act_all"),c=f.find("#block_act_short");return b.click(function(){return e(),!1}),c.click(function(){return d(!1),!1}),!1}function y(b,c,d){switch(b){case"show":c?a("#"+c).html('<div id="loader"></div>').hide().fadeIn("fast"):(a("body").append('<div id="overlay"></div><div id="preloader">Working..</div>'),a("#overlay, #preloader").hide().fadeIn("fast"));break;case"hide":c?a("#"+c).fadeOut("fast"):a("#overlay, #preloader").fadeOut("fast",function(){a(this).remove()});break;case"result":if(!c)return;a("#"+c).html(d).show();break;case"error":if(!c)return;a("#"+c).html("Không tìm thấy liên kết: <b>"+d+"</b>").hide().fadeIn("fast")}}var f=a(this),g=a.extend({},c[d],e);switch(d){case"lightbox":h();break;case"loadAjax":i();break;case"formAction":g.submit&&k(),f.submit(k),f.find("input[type=submit]").click(k),f.find("[_autocheck]").change(j);break;case"verifyAction":f.click(m);break;case"confirmAction":f.click(n);break;case"placeholder":o();break;case"toggleTab":p(),f.change(function(){p()});break;case"toggleAction":q();break;case"tooltip":r();break;case"dropdown":s();break;case"copyValue":t();break;case"accordion":u();break;case"tabs":v();break;case"moreList":w();break;case"moreBlock":x();break;default:alert("Không tìm thấy thuộc tính: "+method)}})}}(jQuery);